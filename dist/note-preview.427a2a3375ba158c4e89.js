(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{537:function(e,t,r){"use strict";r.r(t),r.d(t,"NotePreview",(function(){return g}));var a=r(0),n=r.n(a),c=r(65),s=r(287),o=r(272),i=r(532),l=r.n(i),u=r(533),d=r.n(u),h=r(24),p={type:"output",regex:'<input type="checkbox" disabled',replace:'<input type="checkbox" '},v=e=>r.e(18).then(r.t.bind(null,1010,7)).then(t=>{var{default:r}=t;r.extension("enableCheckboxes",p);var a=new r.Converter({extensions:["enableCheckboxes"]});a.setFlavor("github"),a.setOption("simpleLineBreaks",!1),a.setOption("ghMentions",!1),a.setOption("smoothLivePreview",!0),a.setOption("tables",!0),a.setOption("strikethrough",!0);var n=e.replace(/([ \t\u2000-\u200a]*)\u2022(\s)/gm,"$1-$2");return(e=>{for(var t=(new DOMParser).parseFromString(e,"text/html"),r=t.createTreeWalker(t.body,NodeFilter.SHOW_ALL,null,!1),a=[],n=[],c=function(){var e=r.currentNode;if((e=>{switch(e.nodeName.toLowerCase()){case"head":case"html":case"iframe":case"link":case"meta":case"object":case"script":case"style":return!0;default:return!1}})(e))return n.push(e),"continue";if(!(e=>{var t=e.nodeName.toLowerCase();if("input"===t)return"checkbox"===e.getAttribute("type");switch(t){case"#text":case"a":case"article":case"b":case"br":case"blockquote":case"cite":case"code":case"dd":case"del":case"div":case"dt":case"em":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":case"hr":case"i":case"img":case"ins":case"kbd":case"li":case"ol":case"p":case"pre":case"s":case"span":case"strong":case"sub":case"sup":case"table":case"tbody":case"td":case"th":case"thead":case"tr":case"tt":case"ul":return!0;default:return!1}})(e))return a.push(e),"continue";var t=e.nodeName.toLowerCase();Object(h.filter)(e.attributes,e=>{var{name:r,value:a}=e;return!((e,t,r)=>{switch(e){case"a":switch(t){case"href":return["http","https","simplenote"].includes(r.toLowerCase().trim().split("://")[0]);case"alt":case"rel":case"title":return!0;default:return!1}case"img":switch(t){case"alt":case"src":case"title":case"width":return!0;default:return!1}case"input":switch(t){case"disabled":case"checked":case"type":return!0;default:return!1}case"li":switch(t){case"class":switch(r){case"task-list-item":return!0;default:return!1}default:return!1}case"ol":switch(t){case"start":return!0;default:return!1}case"th":case"td":switch(t){case"style":switch(r){case"text-align:center;":case"text-align:left;":case"text-align:right;":return!0;default:return!1}default:return!1}default:return!1}})(t,r,a)&&(("href"!==r&&"src"!==r||!d.a.isWebUri(a))&&("href"!==r||!a.startsWith("mailto:")||!l.a.validate(a.slice(7))))}).forEach(t=>{var{name:r}=t;return e.removeAttribute(r)});var c="a"===t&&e.getAttribute("href");"a"!==t||"string"!=typeof c||c.startsWith("mailto:")||(e.setAttribute("target","_blank"),e.setAttribute("rel","external noopener noreferrer")),"li"===t&&"task-list-item"===e.getAttribute("class")&&e.setAttribute("style","list-style: none;")};r.nextNode();)c();return n.forEach(e=>{try{var t;null==e||null===(t=e.parentNode)||void 0===t||t.removeChild(e)}catch(e){}}),a.forEach(e=>{var t,r=e.parentNode;try{for(;t=e.firstChild;)null==r||r.insertBefore(t,e);null==r||r.removeChild(e)}catch(e){}}),t.body.innerHTML})(a.makeHtml(n))}),f=(e,t)=>{var r=e.parentNode;t.forEach(e=>{r.childNodes.forEach(r=>{var a,n,c;if(r.nodeType===Node.TEXT_NODE&&null!==(a=r.textContent)&&void 0!==a&&a.toLocaleLowerCase().includes(e)){var s=null===(n=r.textContent)||void 0===n?void 0:n.toLocaleLowerCase().indexOf(e),o=r.splitText(s),i=o.splitText(e.length),l=document.createElement("span");l.setAttribute("class","search-match"),null===(c=o.parentNode)||void 0===c||c.replaceChild(l,o),l.appendChild(o),f(i,t)}})})},m=(e,t,a)=>v(t).then(t=>(e.innerHTML=t,e)).then(e=>{if(!a)return e.querySelectorAll("pre code");var t=Object(o.a)(a).map(e=>e.toLocaleLowerCase());if(!t.length)return e.querySelectorAll("pre code");for(var r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:function(e){return t.some(t=>{var r;return null===(r=e.textContent)||void 0===r?void 0:r.toLocaleLowerCase().includes(t)})?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},!1),n=[],c=r.currentNode;c;)n.push(c),c=r.nextNode();return n.forEach(e=>f(e,t)),e.querySelectorAll("pre code")}).then(e=>{if(e.length)return r.e(14).then(r.t.bind(null,1009,7)).then(t=>{var{default:r}=t;e.forEach(r.highlightBlock)}).catch()}),b=r(32),w=r(214),g=e=>{var t,{"aria-hidden":r,editNote:c,isFocused:o,note:i,noteId:l,notes:u,openNote:d,searchQuery:h,showRenderedView:p}=e,v=Object(a.useRef)();return Object(a.useEffect)(()=>{var e=e=>{if(!o)return!0;if(!document.getSelection().isCollapsed)return!0;var t=document.createElement("div");m(t,i.content,h).then(()=>{try{e.clipboardData.setData("text/plain",t.innerHTML)}catch(e){navigator.clipboard.writeText(t.innerHTML)}}),e.preventDefault()};return document.addEventListener("copy",e,!1),()=>document.removeEventListener("copy",e,!1)},[o,h]),Object(a.useEffect)(()=>{var e,t=e=>{for(var t,r,a=e.target;null!==a;a=a.parentNode)if("A"===a.tagName){e.preventDefault(),e.stopPropagation();var n=a;if(n.href.startsWith("simplenote://note/")){var o=/^simplenote:\/\/note\/(.+)$/.exec(n.href);if(!o)return;var[h,p]=o;return void(u.has(p)&&d(p))}return void(n.href.startsWith("http://localhost")||Object(b.a)(n.href))}var f="INPUT"===(null==e||null===(t=e.target)||void 0===t?void 0:t.tagName)?e.target.parentElement:e.target;if("INPUT"!==(null==f||null===(r=f.children[0])||void 0===r?void 0:r.tagName));else{e.preventDefault(),e.stopPropagation();var m=v.current.querySelectorAll("[data-markdown-root] .task-list-item"),w=Array.prototype.indexOf.call(m,f),g=0,N=i.content.replace(s.a,(e,t,r,a)=>t+(g++===w?" "===r?"- [x]":"- [ ]":" "===r?"- [ ]":"- [x]")+a);c(l,{content:N})}};return null===(e=v.current)||void 0===e||e.addEventListener("click",t,!0),()=>{var e;return null===(e=v.current)||void 0===e?void 0:e.removeEventListener("click",t,!0)}},[i.content]),Object(a.useEffect)(()=>{var e;v.current&&(null!=i&&i.content&&p?m(v.current,i.content,h):v.current.innerText=Object(s.b)(null!==(e=null==i?void 0:i.content)&&void 0!==e?e:""))},[null==i?void 0:i.content,h,p]),n.a.createElement("div",{"aria-hidden":r,className:"note-detail-wrapper"},n.a.createElement("div",{className:"note-detail note-detail-preview"},n.a.createElement("div",{ref:v,className:"note-detail-markdown theme-color-bg theme-color-fg","data-markdown-root":!0},n.a.createElement("div",{style:{whiteSpace:"pre"}},!p&&Object(s.b)(null!==(t=null==i?void 0:i.content)&&void 0!==t?t:"")))))},N={editNote:w.a.data.editNote,openNote:w.a.ui.selectNote};t.default=Object(c.b)((e,t)=>{var r,a,n=null!==(r=t.noteId)&&void 0!==r?r:e.ui.openedNote,c=null!==(a=t.note)&&void 0!==a?a:e.data.notes.get(n);return{isFocused:0===e.ui.dialogs.length&&!e.ui.showNoteInfo,note:c,noteId:n,notes:e.data.notes,searchQuery:e.ui.searchQuery,showRenderedView:!(null==c||!c.systemTags.includes("markdown")||e.ui.editMode)}},N)(g)}}]);