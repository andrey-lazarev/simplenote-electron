(window.webpackJsonp=window.webpackJsonp||[]).push([[6,8],{1013:function(e,t,o){"use strict";o.r(t),o.d(t,"NoteEditor",(function(){return V}));var i=o(5),n=o.n(i),r=o(0),s=o.n(r),a=o(65),l=o(384);function c(){return s.a.createElement("svg",{className:"icon-chevron-right",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},s.a.createElement("rect",{x:"0",fill:"none",width:"24",height:"24"}),s.a.createElement("path",{d:"M10.11 21.19L8.7 19.78 16.48 12 8.7 4.22l1.41-1.41L19.3 12 10.11 21.19z"}))}var d=e=>{var{selectedSearchMatchIndex:t,numberOfMatchesInNote:o,setSearchSelection:i}=e;return s.a.createElement("div",{className:"search-results"},s.a.createElement("div",null,null===t?"".concat(o," Results"):"".concat(t+1," of ").concat(o)),s.a.createElement("span",{className:"search-results-next"},s.a.createElement(l.a,{disabled:o<=1,icon:s.a.createElement(c,null),onClick:e=>{i((o+(null!=t?t:-1)+1)%o)},title:"Next"})),s.a.createElement("span",{className:"search-results-prev"},s.a.createElement(l.a,{disabled:o<=1,icon:s.a.createElement(c,null),onClick:e=>{i((o+(null!=t?t:-1)-1)%o)},title:"Prev"})))};d.displayName="SearchResultsBar";var u=Object(a.b)(e=>{var{ui:{selectedSearchMatchIndex:t,numberOfMatchesInNote:o}}=e;return{selectedSearchMatchIndex:t,numberOfMatchesInNote:o}},e=>({setSearchSelection:t=>e({type:"STORE_SEARCH_SELECTION",index:t})}))(d),h=o(911),p=o(24),g=o(70),m=o(240),v=Object(a.b)(null,e=>({openShareDialog:()=>e(Object(m.showDialog)("SHARE"))}))(e=>{var{openShareDialog:t}=e;return s.a.createElement("div",{className:"tag-email-tooltip"},s.a.createElement("div",{className:"tag-email-tooltip__arrow"}),s.a.createElement("div",{className:"tag-email-tooltip__inside"},"Collaboration has moved. Press the Share icon in the toolbar to access the ",s.a.createElement("a",{href:"#",onClick:t},"Collaborate screen"),"."))}),f=o(78),b=o(20),y=o.n(b),S=e=>{var{onSelect:t,selected:o,tagName:i}=e;return s.a.createElement("div",{className:y()("tag-chip",{selected:o}),"data-tag-name":i,onClick:t},i,s.a.createElement("span",{className:"remove-tag-icon"},s.a.createElement(f.a,null)))},C=e=>{if(!e||!window.getSelection)return 0;var t=window.getSelection();if(!t||t.rangeCount<1)return 0;var o=t.getRangeAt(0),i=o.cloneRange();return i.selectNodeContents(e),i.setEnd(o.endContainer,o.endOffset),i.toString().length};class E extends r.Component{constructor(){for(var e,t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];super(...o),e=this,n()(this,"inputField",void 0),n()(this,"inputObserver",void 0),n()(this,"caretPosition",0),n()(this,"state",{isComposing:!1}),n()(this,"completeSuggestion",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p.identity,{onChange:o,note:i,tags:n,value:r}=e.props;if(r.length){var s=null;for(var a of n.values())if(!i.tags.includes(a.name)&&a.name.startsWith(r)){s=a.name;break}s&&o(s,()=>{var o;t(s),e.caretPosition=(null===(o=s)||void 0===o?void 0:o.length)||0,e.focusInput()})}})),n()(this,"focusInput",()=>{if(this.inputField){var e=this.inputField;e.focus();var t=document.createRange();t.selectNodeContents(e),null!==e.firstChild&&t.toString().length>this.caretPosition&&t.setEnd(e.firstChild,this.caretPosition),t.collapse(!1);var o=window.getSelection();o.removeAllRanges(),o.addRange(t)}}),n()(this,"hasFocus",()=>document.activeElement===this.inputField),n()(this,"interceptKeys",e=>Object(p.invoke)({13:this.submitTag,32:this.submitTag,188:this.submitTag,9:this.interceptTabPress,39:this.interceptRightArrow},e.keyCode,e)),n()(this,"interceptRightArrow",e=>{var{value:t}=this.props;C(e.currentTarget)===t.length&&(this.completeSuggestion(),e.preventDefault(),e.stopPropagation())}),n()(this,"interceptTabPress",e=>{this.completeSuggestion(this.submitTag),e.preventDefault(),e.stopPropagation()}),n()(this,"onInputMutation",e=>{e.forEach(e=>{var t=Object(p.get)(e,"target.data","");"childList"===e.type&&e.addedNodes.length&&(t=Object(p.get)(e,"target.innerText","")),this.onInput(t)})}),n()(this,"onInput",(function(t){var{moveCaretToEndOfValue:o=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.state.isComposing||(e.caretPosition=o?t.length:C(e.inputField),e.props.onChange(t.trim(),e.focusInput))})),n()(this,"onCompositionEnd",e=>{var t=e.target.textContent;this.setState({isComposing:!1},()=>this.onInput(t))}),n()(this,"parsePastedInput",e=>{var t;Object(p.get)(e,"clipboardData.getData")?t=e.clipboardData.getData("text/plain"):Object(p.get)(window,"clipboardData.getData")&&(t=window.clipboardData.getData("Text"));var o=t.split(/\s|,|\n/),i=o.slice(0,o.length-1),[n]=o.slice(o.length-1);i.filter(Boolean).forEach(this.props.onSelect),this.onInput(n,{moveCaretToEndOfValue:!0}),e.preventDefault(),e.stopPropagation()}),n()(this,"storeInput",e=>{this.inputField=e,this.props.inputRef(e),Object(p.invoke)(this,"inputField.addEventListener","paste",this.parsePastedInput,!1)}),n()(this,"submitTag",e=>{var{onSelect:t,value:o}=this.props;o.trim().length&&t(o.trim()),Object(p.invoke)(e,"preventDefault"),Object(p.invoke)(e,"stopPropagation")})}componentDidMount(){this.props.storeFocusInput(this.focusInput),this.props.storeHasFocus(this.hasFocus),this.inputObserver=new MutationObserver(this.onInputMutation),this.inputObserver.observe(this.inputField,{characterData:!0,childList:!0,subtree:!0})}componentWillUnmount(){Object(p.invoke)(this,"inputField.removeEventListener","paste",this.parsePastedInput,!1),this.inputObserver.disconnect()}render(){var{note:e,tags:t,value:o}=this.props,i=null;if(o.length>0)for(var n of t.values())if(!e.tags.includes(n.name)&&n.name.startsWith(o)){i=n.name;break}var r=""===o&&!this.state.isComposing;return s.a.createElement("div",{className:"tag-input",onClick:()=>{this.caretPosition=C(this.inputField),this.focusInput()}},r&&s.a.createElement("span",{"aria-hidden":!0,className:"tag-input__placeholder theme-color-fg-dim"},"Add tag…"),s.a.createElement("div",{"aria-label":"Add tag…",ref:this.storeInput,className:"tag-input__entry",contentEditable:"true",onBlur:this.submitTag,onCompositionStart:()=>this.setState({isComposing:!0}),onCompositionEnd:this.onCompositionEnd,onKeyDown:this.interceptKeys,spellCheck:!1,suppressContentEditableWarning:!0},o),s.a.createElement("div",{className:"tag-input__suggestion",disabled:!0,type:"text"},i?i.substring(o.length):""))}}n()(E,"displayName","TagInput"),n()(E,"defaultProps",{inputRef:p.identity,onChange:p.identity,onSelect:p.identity,storeFocusInput:p.noop,storeHasFocus:p.noop});var w=Object(a.b)(e=>({note:e.data.notes.get(e.ui.openedNote),tags:e.data.tags}))(E),N=o(273);class T extends r.Component{constructor(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];super(...t),n()(this,"container",Object(r.createRef)()),n()(this,"focusInput",void 0),n()(this,"hiddenTag",void 0),n()(this,"inputHasFocus",void 0),n()(this,"tagInput",Object(r.createRef)()),n()(this,"state",{selectedTag:"",showEmailTooltip:!1,tagInput:""}),n()(this,"addTag",e=>{var{note:t,noteId:o}=this.props,i=e.trim().replace(/\s+/g,",").split(",");i.some(g.a)&&this.showEmailTooltip();var n=new Set(t.tags.map(N.a));i.forEach(e=>{n.has(Object(N.a)(e))||(n.add(Object(N.a)(e)),this.props.addTag(o,e))}),this.storeTagInput(""),Object(p.invoke)(this,"tagInput.focus")}),n()(this,"hasSelection",()=>this.state.selectedTag&&!!this.state.selectedTag.length),n()(this,"deleteTag",e=>{var{noteId:t}=this.props,{selectedTag:o}=this.state;this.props.removeTag(t,e),o===e&&this.setState({selectedTag:""},()=>{var e,t;return null===(e=this.tagInput)||void 0===e||null===(t=e.current)||void 0===t?void 0:t.focus()})}),n()(this,"deleteSelection",()=>{this.hasSelection()&&this.deleteTag(this.state.selectedTag)}),n()(this,"hideEmailTooltip",()=>this.setState({showEmailTooltip:!1})),n()(this,"hasFocus",()=>!!this.inputHasFocus&&this.inputHasFocus()),n()(this,"focusTagField",()=>this.focusInput&&this.focusInput()),n()(this,"interceptKeys",e=>{if(8===e.which){if(""!==this.state.tagInput)return;return this.hasSelection()&&this.deleteSelection(),this.selectLastTag(),void e.preventDefault()}if(39===e.which&&this.hasSelection())return this.unselect(e),void this.focusTagField();(9===e.which&&this.hasSelection()||this.hasSelection())&&this.unselect(e)}),n()(this,"preventStealingFocus",e=>{var{ctrlKey:t,key:o,metaKey:i,shiftKey:n}=e;if(this.props.keyboardShortcuts)return(t||i)&&n&&"y"===o.toLowerCase()&&this.setState({selectedTag:""}),!0}),n()(this,"selectLastTag",()=>{var e;return this.setState({selectedTag:null===(e=this.props.note)||void 0===e?void 0:e.tags.slice(-1).shift()})}),n()(this,"selectTag",e=>{var{currentTarget:{dataset:{tagName:t}}}=e;e.preventDefault(),e.stopPropagation(),this.deleteTag(t)}),n()(this,"showEmailTooltip",()=>{this.setState({showEmailTooltip:!0}),setTimeout(()=>this.setState({showEmailTooltip:!1}),5e3)}),n()(this,"onKeyDown",e=>(this.state.showEmailTooltip&&this.hideEmailTooltip(),this.interceptKeys(e))),n()(this,"storeFocusInput",e=>this.focusInput=e),n()(this,"storeHasFocus",e=>this.inputHasFocus=e),n()(this,"storeHiddenTag",e=>this.hiddenTag=e),n()(this,"storeInputRef",e=>this.tagInput=e),n()(this,"storeTagInput",(e,t)=>this.setState({tagInput:e},t)),n()(this,"unselect",e=>{var t,o;this.state.selectedTag&&((null===(t=this.hiddenTag)||void 0===t?void 0:t.current)===e.relatedTarget&&void 0!==(null===(o=this.hiddenTag)||void 0===o?void 0:o.current)||this.setState({selectedTag:""}))}),n()(this,"getTagName",e=>{var t;return null===(t=this.props.allTags.get(Object(N.a)(e)))||void 0===t?void 0:t.name})}componentDidMount(){this.props.storeFocusTagField(this.focusTagField),this.props.storeHasFocus(this.hasFocus),document.addEventListener("click",this.unselect,!0),window.addEventListener("keydown",this.preventStealingFocus,!0)}componentWillUnmount(){document.removeEventListener("click",this.unselect,!0),window.removeEventListener("keydown",this.preventStealingFocus,!0)}componentDidUpdate(){var e,t;this.hasSelection()&&(null===(e=this.hiddenTag)||void 0===e||null===(t=e.current)||void 0===t||t.focus())}render(){var{note:e}=this.props,{selectedTag:t,showEmailTooltip:o,tagInput:i}=this.state;return s.a.createElement("div",{ref:this.container,className:"tag-field"},s.a.createElement("div",{"aria-label":"List of tags for the current note, click a tag to remove it",className:y()("tag-editor",{"has-selection":this.hasSelection()}),tabIndex:-1,onKeyDown:this.onKeyDown},s.a.createElement("input",{"aria-hidden":"true",className:"hidden-tag",tabIndex:-1,ref:this.storeHiddenTag}),null==e?void 0:e.tags.filter(Object(p.negate)(g.a)).map(e=>s.a.createElement(S,{key:e,tagName:this.getTagName(e),selected:e===t,onSelect:this.selectTag})),s.a.createElement(w,{inputRef:this.storeInputRef,value:i,onChange:this.storeTagInput,onSelect:this.addTag,storeFocusInput:this.storeFocusInput,storeHasFocus:this.storeHasFocus}),s.a.createElement(h.a,{container:this.container.current,onHide:this.hideEmailTooltip,placement:"top",rootClose:!0,shouldUpdatePosition:!0,show:o,target:this.tagInput.current},()=>s.a.createElement(v,null))))}}n()(T,"displayName","TagField");var k=Object(a.b)(e=>({allTags:e.data.tags,keyboardShortcuts:e.settings.keyboardShortcuts,noteId:e.ui.openedNote,note:e.data.notes.get(e.ui.openedNote)}),{addTag:(e,t)=>({type:"ADD_NOTE_TAG",noteId:e,tagName:t}),removeTag:(e,t)=>({type:"REMOVE_NOTE_TAG",noteId:e,tagName:t})})(T),x=o(643),I=o(699),O=o(224),M=o(470),F=o(214),L=o(66),D=o(272),A=o(298),R=o(21),P=o(287);function K(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function j(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?K(Object(o),!0).forEach((function(t){n()(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):K(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var _=e=>({range:new I.Range(e,1,e,1),options:{isWholeLine:!0,inlineClassName:"note-title",stickiness:I.editor.TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges}});class H extends r.Component{constructor(){super(...arguments),n()(this,"bootTimer",null),n()(this,"editor",null),n()(this,"monaco",null),n()(this,"contentDiv",Object(r.createRef)()),n()(this,"decorations",[]),n()(this,"matchesInNote",[]),n()(this,"state",{content:"",editor:"fast",noteId:null,overTodo:!1,searchQuery:""}),n()(this,"toggleShortcuts",e=>{e?window.addEventListener("keydown",this.handleShortcut,!0):window.removeEventListener("keydown",this.handleShortcut,!0)}),n()(this,"completionProvider",(e,t)=>({triggerCharacters:["["],provideCompletionItems(t,o,i,n){var r=t.getLineContent(o.lineNumber),s=r.lastIndexOf("[",o.column),a=r.lastIndexOf("]",o.column),l=s>=0&&a<s?s:-1,c=l>=0?r.slice(l+1,o.column):"",d=Object(M.b)({collection:{type:"all"},excludeIDs:e?[e]:[],searchTags:Object(M.c)(c),searchTerms:Object(D.a)(c),titleOnly:!0},5).map(e=>{var[t,o]=e;return j({noteId:t,content:o.content,isPinned:o.systemTags.includes("pinned")},Object(A.c)(o))}),u=l>=0?[{text:"",range:{startLineNumber:o.lineNumber,startColumn:l,endLineNumber:o.lineNumber,endColumn:o.column}}]:[];return{incomplete:!0,suggestions:d.map((e,t)=>({additionalTextEdits:u,kind:e.isPinned?I.languages.CompletionItemKind.Snippet:I.languages.CompletionItemKind.File,label:e.title,documentation:e.content,insertText:"[".concat(e.title,"](simplenote://note/").concat(e.noteId,")"),sortText:t.toString(),range:{startLineNumber:o.lineNumber,startColumn:o.column,endLineNumber:o.lineNumber,endColumn:o.column}}))}}})),n()(this,"handleShortcut",e=>{var{ctrlKey:t,metaKey:o,shiftKey:i}=e,n=e.key.toLowerCase(),r=t||o;return r&&i&&"g"===n?(this.setPrevSearchSelection(),e.stopPropagation(),e.preventDefault(),!1):window.electron||!r||i||"g"!==n?void 0:(this.setNextSearchSelection(),e.stopPropagation(),e.preventDefault(),!1)}),n()(this,"setDecorators",()=>{var e,t;this.matchesInNote=null!==(e=this.searchMatches())&&void 0!==e?e:[],this.props.storeNumberOfMatchesInNote(this.matchesInNote.length);var o=null!==(t=this.getTitleDecoration())&&void 0!==t?t:[];this.decorations=this.editor.deltaDecorations(this.decorations,[...this.matchesInNote,...o])}),n()(this,"getTitleDecoration",()=>{var e=this.editor.getModel();if(e)for(var t=1;t<=e.getLineCount();t++){if(e.getLineContent(t).trim().length>0)return[_(t)]}}),n()(this,"searchMatches",()=>{if(this.editor&&this.props.searchQuery){var e=this.editor.getModel(),t=Object(D.a)(this.props.searchQuery).map(e=>e.normalize().toLowerCase()).filter(e=>e.trim().length>0);if(0===t.length)return[];var o=e.getValue().normalize().toLowerCase();return t.reduce((t,i)=>{for(var n=null,r=0;-1!==n&&-1!==(n=o.indexOf(i,r));){r=n+i.length;var s=e.getPositionAt(n),a=e.getPositionAt(n+i.length);t.push({options:{inlineClassName:"search-decoration",overviewRuler:{color:"#3361cc",position:I.editor.OverviewRulerLane.Full}},range:{startLineNumber:s.lineNumber,startColumn:s.column,endLineNumber:a.lineNumber,endColumn:a.column}})}return t},[])}}),n()(this,"focusEditor",()=>{var e;return null===(e=this.editor)||void 0===e?void 0:e.focus()}),n()(this,"hasFocus",()=>{var e;return null===(e=this.editor)||void 0===e?void 0:e.hasTextFocus()}),n()(this,"handleChecklist",e=>{var t;null===(t=this.editor)||void 0===t||t.trigger("editorCommand","insertChecklist",null)}),n()(this,"handleUndoRedo",e=>{var t,o;switch(e.inputType){case"historyUndo":return null===(t=this.editor)||void 0===t||t.trigger("browserMenu","undo",null),e.preventDefault(),void e.stopPropagation();case"historyRedo":return null===(o=this.editor)||void 0===o||o.trigger("browserMenu","redo",null),e.preventDefault(),void e.stopPropagation()}}),n()(this,"cancelSelectionOrSearch",e=>{this.props.searchQuery.length>0&&this.matchesInNote.length>0?this.props.clearSearch():e.trigger("customAction","cancelSelection",null)}),n()(this,"insertOrRemoveCheckboxes",e=>{var t=e.getSelection();if(t)for(var o=t.startLineNumber;o<=t.endLineNumber;o++)this.toggleChecklistForLine(e,o);else{var i=e.getPosition();if(!i)return;this.toggleChecklistForLine(e,i.lineNumber)}}),n()(this,"toggleChecklistForLine",(e,t)=>{var o,i,n=e.getModel();if(n){var r=n.getLineContent(t),s=/^(\s*)([-+*\u2022]\s*)?([\ue000\ue001]\s+)?/.exec(r);if(s){var[a,l,c,d]=s,u=void 0!==d,h=l.length+(null!==(o=null==c?void 0:c.length)&&void 0!==o?o:0)+1,p=u?"":" ",g={identifier:{major:1,minor:1},range:new this.monaco.Range(t,h,t,h+(null!==(i=null==d?void 0:d.length)&&void 0!==i?i:0)),text:p,forceMoveMarkers:!0};e.executeEdits("insertOrRemoveCheckboxes",[g]),this.props.insertTask()}}}),n()(this,"editorInit",e=>{I.editor.defineTheme("simplenote",{base:"vs",inherit:!0,rules:[{background:"FFFFFF",foreground:"#2c3338"}],colors:{"editor.foreground":"#2c3338","editor.background":"#ffffff","editor.selectionBackground":"#ced9f2","scrollbarSlider.activeBackground":"#8c8f94","scrollbarSlider.background":"#c3c4c7","scrollbarSlider.hoverBackground":"#a7aaad","textLink.foreground":"#1d4fc4"}}),I.editor.defineTheme("simplenote-dark",{base:"vs-dark",inherit:!0,rules:[{background:"1d2327",foreground:"ffffff"}],colors:{"editor.foreground":"#ffffff","editor.background":"#1d2327","editor.selectionBackground":"#50575e","scrollbarSlider.activeBackground":"#646970","scrollbarSlider.background":"#2c3338","scrollbarSlider.hoverBackground":"#1d2327","textLink.foreground":"#ced9f2"}})}),n()(this,"editorReady",(e,t)=>{var o,i,n;this.editor=e,this.monaco=t,t.languages.registerLinkProvider("plaintext",{provideLinks:e=>({links:e.findMatches("simplenote://note/[a-zA-Z0-9-]+",!0,!0,!1,null,!1).map(e=>{var{range:t}=e;return{range:t}})}),resolveLink:t=>{var o,i,n=null!==(o=null===(i=e.getModel())||void 0===i?void 0:i.getValueInRange(t.range))&&void 0!==o?o:"",r=/^simplenote:\/\/note\/(.+)$/.exec(n);if(r){var[s,a]=r;return this.props.notes.has(a)&&this.props.openNote(a),j(j({},t),{},{url:"#"})}}});var r=["cancelSelection","cursorUndo","editor.action.commentLine","editor.action.jumpToBracket","editor.action.transposeLetters","expandLineSelection","editor.action.gotoLine","editor.action.insertCursorAbove","editor.action.insertCursorBelow","editor.action.insertCursorAtEndOfEachLineSelected","actions.find","actions.findWithSelection","editor.action.addSelectionToNextFindMatch","editor.action.nextMatchFindAction","editor.action.selectHighlights"];window.electron&&R.c&&r.push("undo","redo","editor.action.selectAll"),r.forEach((function(t){e._standaloneKeybindingService.addDynamicKeybinding("-"+t,void 0,()=>{})})),e.createContextKey("allowBrowserKeybinding",!window.electron),e.addAction({id:"context_undo",label:"Undo",keybindings:[t.KeyMod.CtrlCmd|t.KeyCode.KEY_Z],keybindingContext:"allowBrowserKeybinding",contextMenuGroupId:"1_modification",contextMenuOrder:2,run:()=>{e.trigger("contextMenu","undo",null)}}),e.addAction({id:"context_redo",label:"Redo",keybindings:[t.KeyMod.WinCtrl|t.KeyCode.KEY_Y,t.KeyMod.CtrlCmd|t.KeyMod.Shift|t.KeyCode.KEY_Z],keybindingContext:"allowBrowserKeybinding",contextMenuGroupId:"1_modification",contextMenuOrder:3,run:()=>{e.trigger("contextMenu","redo",null)}}),e.addAction({id:"context_cut",label:"Cut",keybindings:[t.KeyMod.CtrlCmd|t.KeyCode.KEY_X],keybindingContext:"allowBrowserKeybinding",contextMenuGroupId:"9_cutcopypaste",contextMenuOrder:1,run:()=>{e.trigger("contextMenu","editor.action.clipboardCutAction",null)}}),e.addAction({id:"context_copy",label:"Copy",keybindings:[t.KeyMod.CtrlCmd|t.KeyCode.KEY_C],keybindingContext:"allowBrowserKeybinding",contextMenuGroupId:"9_cutcopypaste",contextMenuOrder:2,run:()=>{e.trigger("contextMenu","editor.action.clipboardCopyAction",null)}}),e.addAction({id:"cancel_selection",label:"Cancel Selection",keybindings:[t.KeyCode.Escape],keybindingContext:"!suggestWidgetVisible",run:this.cancelSelectionOrSearch}),window.electron&&e.addAction({id:"paste",label:"Paste",contextMenuGroupId:"9_cutcopypaste",contextMenuOrder:3,keybindings:[t.KeyMod.CtrlCmd|t.KeyCode.KEY_V],keybindingContext:"allowBrowserKeybinding",run:()=>{document.execCommand("paste")}}),e.addAction({id:"select_all",label:"Select All",contextMenuGroupId:"9_cutcopypaste",contextMenuOrder:4,keybindings:[t.KeyMod.CtrlCmd|t.KeyCode.KEY_A],keybindingContext:"allowBrowserKeybinding",run:()=>{e.setSelection(e.getModel().getFullModelRange())}}),e.addAction({id:"insertChecklist",label:"Insert Checklist",keybindings:[t.KeyMod.CtrlCmd|t.KeyMod.Shift|t.KeyCode.KEY_C,t.KeyMod.WinCtrl|t.KeyMod.Shift|t.KeyCode.KEY_C],keybindingContext:"allowBrowserKeybinding",contextMenuGroupId:"10_checklist",contextMenuOrder:1,run:this.insertOrRemoveCheckboxes}),e.addAction({id:"selectUpWithoutMulticursor",label:"Select Up",keybindings:[t.KeyMod.CtrlCmd|t.KeyMod.Shift|t.KeyCode.UpArrow],run:()=>{e.trigger("shortcuts","cursorUpSelect",null)}}),e.addAction({id:"selectDownWithoutMulticursor",label:"Select Down",keybindings:[t.KeyMod.CtrlCmd|t.KeyMod.Shift|t.KeyCode.DownArrow],run:()=>{e.trigger("shortcuts","cursorDownSelect",null)}}),e.addCommand(t.KeyCode.Tab,()=>{var t,o,i=null===(t=e.getPosition())||void 0===t?void 0:t.lineNumber;if(i){var n=null===(o=e.getModel())||void 0===o?void 0:o.getLineContent(i);n&&/^(\s*)([-+*\u2022\ue000\ue001])(\s+)/.test(n)?e.trigger("commands","editor.action.indentLines",null):e.trigger("commands","tab",null)}}),null===(o=window.electron)||void 0===o||o.receive("editorCommand",t=>{switch(t.action){case"findAgain":return void this.setNextSearchSelection();case"insertChecklist":return void e.trigger("editorCommand","insertChecklist",null);case"redo":return void(e.hasTextFocus()?e.trigger("editorCommand","redo",null):document.execCommand("redo"));case"selectAll":return void(e.hasTextFocus()?e.setSelection(e.getModel().getFullModelRange()):document.execCommand("selectAll"));case"undo":return void(e.hasTextFocus()?e.trigger("editorCommand","undo",null):document.execCommand("undo"))}}),window.electron||window.addEventListener("input",this.handleUndoRedo,!0),this.setDecorators(),this.setState({}),e.onDidChangeModelContent(()=>this.setDecorators());var s=t.languages.registerCompletionItemProvider("plaintext",this.completionProvider(this.state.noteId,e));e.onDidDispose(()=>null==s?void 0:s.dispose()),t.languages.setLanguageConfiguration("plaintext",{wordPattern:/[^\s]+/g}),document.oncopy=e=>{e.clipboardData.setData("text/plain",Object(P.c)(e.clipboardData.getData("text/plain")))};var[a,l,c]=this.props.editorSelection,d=null===(i=this.editor.getModel())||void 0===i?void 0:i.getPositionAt(a),u=null===(n=this.editor.getModel())||void 0===n?void 0:n.getPositionAt(l);this.editor.setSelection(I.Selection.createWithDirection(null==d?void 0:d.lineNumber,null==d?void 0:d.column,null==u?void 0:u.lineNumber,null==u?void 0:u.column,"RTL"===c?I.SelectionDirection.RTL:I.SelectionDirection.LTR)),e.revealLine(d.lineNumber,I.editor.ScrollType.Immediate),e.onDidChangeCursorSelection(t=>{var o,i;if(t.reason!==I.editor.CursorChangeReason.Undo&&t.reason!==I.editor.CursorChangeReason.Redo){var n=null===(o=e.getModel())||void 0===o?void 0:o.getOffsetAt(t.selection.getStartPosition()),r=null===(i=e.getModel())||void 0===i?void 0:i.getOffsetAt(t.selection.getEndPosition()),s=t.selection.getDirection()===I.SelectionDirection.LTR?"LTR":"RTL";this.props.storeEditorSelection(this.props.noteId,n,r,s)}}),e.onMouseMove(t=>{var{content:o}=this.state,{target:{range:i}}=t;if(i&&!(i.endColumn-i.startColumn>1)){var n=e.getModel();if(n){var r=n.getOffsetAt({lineNumber:i.startLineNumber,column:i.startColumn}),s=""===o[r]||""===o[r];this.state.overTodo!==s&&this.setState({overTodo:s})}}}),e.onMouseDown(t=>{var{editNote:o,noteId:i}=this.props,{content:n}=this.state,{target:{range:r}}=t;if(r&&!(r.endColumn-r.startColumn>1)){var s=e.getModel();if(s){var a=s.getOffsetAt({lineNumber:r.startLineNumber,column:r.startColumn});""===n[a]?o(i,{content:Object(P.c)(n.slice(0,a)+""+n.slice(a+1))}):""===n[a]&&o(i,{content:Object(P.c)(n.slice(0,a)+""+n.slice(a+1))})}}})}),n()(this,"updateNote",(e,t)=>{var{editNote:o,noteId:i}=this.props;if(this.editor){var n=(()=>{if(this.editor&&!t.isRedoing&&!t.isUndoing){var o=t.changes.find(e=>{var{text:t}=e;return("\r"===t[0]||"\n"===t[0])&&""===t.trim()});if(o){var i=o.range.startLineNumber;if(0!==i&&i===o.range.endLineNumber){var n=this.editor.getModel(),r=n.getLineContent(i),s=/^(\s*)([-+*\u2022\ue000\ue001])(\s+)/.exec(r);if(null!==s){var a=n.getLineContent(i+1);if(/^\s*$/.test(a)){if(!(0===a.trim().length&&r.length===s[0].length)){var l=n.getOffsetAt({column:0,lineNumber:i+1}),c=n.getOffsetAt({column:0,lineNumber:i+2}),d={identifier:{major:1,minor:1},range:new this.monaco.Range(i+1,0,i+1,a.length),text:s[0].replace("",""),forceMoveMarkers:!0};return this.editor.executeEdits("autolist",[d]),Promise.resolve().then(()=>this.editor.setPosition({column:s[0].length+1,lineNumber:i+1})),e.slice(0,l)+s[0].replace("","")+t.eol+e.slice(c)}n.getOffsetAt({column:0,lineNumber:i}),n.getOffsetAt({column:0,lineNumber:i+1});var u={identifier:{major:1,minor:1},range:new this.monaco.Range(i,0,i+1,a.length+1),text:null,forceMoveMarkers:!0};Promise.resolve().then(()=>{this.editor.executeEdits("autolist",[u]),this.editor.setPosition({column:0,lineNumber:i})})}}}}}})()||e;o(i,{content:Object(P.c)(n)})}}),n()(this,"setNextSearchSelection",()=>{var{selectedSearchMatchIndex:e}=this.props,t=this.matchesInNote.length,o=(t+(null!=e?e:-1)+1)%t;this.props.storeSearchSelection(o),this.setSearchSelection(o)}),n()(this,"setPrevSearchSelection",()=>{var{selectedSearchMatchIndex:e}=this.props,t=this.matchesInNote.length,o=(t+(null!=e?e:t)-1)%t;this.props.storeSearchSelection(o),this.setSearchSelection(o)}),n()(this,"setSearchSelection",e=>{if(this.matchesInNote.length){var t=this.matchesInNote[e].range;this.editor.setSelection(t),this.editor.revealLineInCenter(t.startLineNumber),this.focusEditor()}})}static getDerivedStateFromProps(e,t){var o=e.note.content.length>5e3,i=e.note.content!==t.content,n=e.noteId!==t.noteId,r=i?n&&o?e.note.content.slice(0,e.editorSelection[1]+5e3):Object(P.b)(e.note.content):t.content,s=n?o?"fast":"full":t.editor,a=e.searchQuery!==t.searchQuery;return(n||a)&&e.storeSearchSelection(0),{content:r,editor:s,noteId:e.noteId,searchQuery:e.searchQuery}}componentDidMount(){var{noteId:e}=this.props;this.bootTimer=setTimeout(()=>{e===this.props.noteId&&this.setState({editor:"full",content:Object(P.b)(this.props.note.content)})},120),this.focusEditor(),this.props.storeFocusEditor(this.focusEditor),this.props.storeHasFocus(this.hasFocus),window.addEventListener("toggleChecklist",this.handleChecklist,!0),this.toggleShortcuts(!0);((e,t)=>{var o=e._first;do{var i,n;t.includes(null===(i=o.element)||void 0===i||null===(n=i.command)||void 0===n?void 0:n.id)&&e._remove(o)}while(o=o.next)})([...O.d._menuItems].find(e=>"EditorContext"===e[0]._debugName)[1],["editor.action.changeAll","editor.action.clipboardCutAction","editor.action.clipboardCopyAction","editor.action.clipboardPasteAction","editor.action.quickCommand"])}componentWillUnmount(){var e;this.bootTimer&&clearTimeout(this.bootTimer),null===(e=window.electron)||void 0===e||e.removeListener("editorCommand"),window.removeEventListener("input",this.handleUndoRedo,!0),window.removeEventListener("toggleChecklist",this.handleChecklist,!0),this.toggleShortcuts(!1)}componentDidUpdate(e){var t,o,{editorSelection:[i,n,r]}=e,{editorSelection:[s,a,l]}=this.props;if(this.editor&&"full"===this.state.editor&&(i!==s||n!==a||r!==l)){var c,d,u=null===(c=this.editor.getModel())||void 0===c?void 0:c.getPositionAt(s),h=null===(d=this.editor.getModel())||void 0===d?void 0:d.getPositionAt(a);this.editor.setSelection(I.Selection.createWithDirection(null==u?void 0:u.lineNumber,null==u?void 0:u.column,null==h?void 0:h.lineNumber,null==h?void 0:h.column,"RTL"===l?I.SelectionDirection.RTL:I.SelectionDirection.LTR))}""===this.props.searchQuery&&""!==e.searchQuery&&(null===(t=this.editor)||void 0===t||t.setSelection(new this.monaco.Range(0,0,0,0)));(this.props.lineLength===e.lineLength&&this.props.isFocusMode===e.isFocusMode||setTimeout(()=>{this.editor&&this.editor.layout()},400),this.editor&&"full"===this.state.editor&&e.searchQuery!==this.props.searchQuery)&&(null===(o=this.editor)||void 0===o||o.layout(),this.setDecorators());this.editor&&"full"===this.state.editor&&e.selectedSearchMatchIndex!==this.props.selectedSearchMatchIndex&&this.setSearchSelection(this.props.selectedSearchMatchIndex)}render(){var e,{lineLength:t,noteId:o,searchQuery:i,theme:n}=this.props,{content:r,editor:a,overTodo:l}=this.state,c=(i&&this.searchMatches(),((e,t)=>"full"===e||void 0===t?25:t<=1072?.1*t:(t-768)/2)(t,null===(e=this.contentDiv.current)||void 0===e?void 0:e.offsetWidth));return s.a.createElement("div",{ref:this.contentDiv,className:"note-content-editor-shell".concat(l?" cursor-pointer":""),onClick:this.focusEditor},s.a.createElement("div",{className:"note-content-plaintext".concat("fast"===a?" visible":"")},r),"fast"!==a&&s.a.createElement(x.default,{key:o,editorDidMount:this.editorReady,editorWillMount:this.editorInit,language:"plaintext",theme:"dark"===n?"simplenote-dark":"simplenote",onChange:this.updateNote,options:{autoClosingBrackets:"never",autoClosingQuotes:"never",autoIndent:"keep",autoSurround:"never",automaticLayout:!0,codeLens:!1,folding:!1,fontFamily:'"Simplenote Tasks", -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen-Sans", "Ubuntu", "Cantarell", "Helvetica Neue", sans-serif',hideCursorInOverviewRuler:!0,lineDecorationsWidth:c,fontSize:16,lineHeight:24,lineNumbers:"off",links:!0,matchBrackets:"never",minimap:{enabled:!1},occurrencesHighlight:!1,overviewRulerBorder:!1,quickSuggestions:!1,renderIndentGuides:!1,renderLineHighlight:"none",scrollbar:{horizontal:"hidden",useShadows:!1,verticalScrollbarSize:c},scrollBeyondLastLine:!1,selectionHighlight:!1,suggestOnTriggerCharacters:!0,unusualLineTerminators:"auto",wordWrap:"bounded",wrappingStrategy:R.d?"simple":"advanced",wordWrapColumn:400},value:r}))}}var W={clearSearch:()=>F.a.ui.search(""),editNote:F.a.data.editNote,insertTask:()=>({type:"INSERT_TASK"}),openNote:F.a.ui.selectNote,storeEditorSelection:(e,t,o,i)=>({type:"STORE_EDITOR_SELECTION",noteId:e,start:t,end:o,direction:i}),storeNumberOfMatchesInNote:e=>({type:"STORE_NUMBER_OF_MATCHES_IN_NOTE",matches:e}),storeSearchSelection:e=>({type:"STORE_SEARCH_SELECTION",index:e})},B=Object(a.b)(e=>{var t;return{editorSelection:null!==(t=e.ui.editorSelection.get(e.ui.openedNote))&&void 0!==t?t:[0,0,"LTR"],isFocusMode:e.settings.focusModeEnabled,keyboardShortcuts:e.settings.keyboardShortcuts,lineLength:e.settings.lineLength,noteId:e.ui.openedNote,note:e.data.notes.get(e.ui.openedNote),notes:e.data.notes,searchQuery:e.ui.searchQuery,selectedSearchMatchIndex:e.ui.selectedSearchMatchIndex,spellCheckEnabled:e.settings.spellCheckEnabled,theme:L.a(e)}},W)(H),U=o(385);class Q extends r.Component{constructor(){super(...arguments),n()(this,"focusEditor",()=>this.focusContentEditor&&this.focusContentEditor()),n()(this,"hasFocus",()=>{var e;return null===(e=this.editorHasFocus)||void 0===e?void 0:e.call(this)}),n()(this,"storeEditorHasFocus",e=>this.editorHasFocus=e),n()(this,"storeFocusContentEditor",e=>this.focusContentEditor=e)}componentDidMount(){this.props.storeFocusEditor(this.focusEditor),this.props.storeHasFocus(this.hasFocus)}render(){var{openedNote:e}=this.props;return s.a.createElement("div",{className:"note-detail-wrapper"},e?s.a.createElement(B,{key:e,storeFocusEditor:this.storeFocusContentEditor,storeHasFocus:this.storeEditorHasFocus}):s.a.createElement("div",{className:"note-detail-placeholder"},s.a.createElement(U.a,null)))}}n()(Q,"displayName","NoteDetail");var G=Object(a.b)(e=>({isDialogOpen:e.ui.dialogs.length>0,keyboardShortcuts:e.settings.keyboardShortcuts,openedNote:e.ui.openedNote}))(Q),Y=o(537);class V extends r.Component{constructor(){super(...arguments),n()(this,"markdownEnabled",()=>{var e;return null===(e=this.props.note)||void 0===e?void 0:e.systemTags.includes("markdown")}),n()(this,"handleShortcut",e=>{if(this.props.keyboardShortcuts){var t,o,{ctrlKey:i,metaKey:n,shiftKey:r}=e,s=e.key.toLowerCase(),{note:a,noteId:l,toggleMarkdown:c}=this.props,d=i||n;return a&&d&&r&&"m"===s?(c(l,!this.markdownEnabled()),e.stopPropagation(),e.preventDefault(),!1):d&&r&&"p"===s&&this.markdownEnabled()?(this.props.toggleEditMode(),e.stopPropagation(),e.preventDefault(),!1):!(r&&d&&"y"===s&&this.props.isEditorActive)||(!this.editFieldHasFocus()||this.props.isSearchActive?(null===(t=this.focusNoteEditor)||void 0===t||t.call(this),e.stopPropagation(),e.preventDefault(),!1):(null===(o=this.focusTagField)||void 0===o||o.call(this),e.stopPropagation(),e.preventDefault(),!1))}}),n()(this,"editFieldHasFocus",()=>this.editorHasFocus&&this.editorHasFocus()),n()(this,"storeEditorHasFocus",e=>this.editorHasFocus=e),n()(this,"storeFocusEditor",e=>this.focusNoteEditor=e),n()(this,"storeFocusTagField",e=>this.focusTagField=e),n()(this,"storeTagFieldHasFocus",e=>this.tagFieldHasFocus=e),n()(this,"tagFieldHasFocus",()=>this.tagFieldHasFocus&&this.tagFieldHasFocus()),n()(this,"toggleShortcuts",e=>{e?window.addEventListener("keydown",this.handleShortcut,!0):window.removeEventListener("keydown",this.handleShortcut,!0)})}componentDidMount(){this.toggleShortcuts(!0)}componentWillUnmount(){this.toggleShortcuts(!1)}render(){var{editMode:e,hasSearchQuery:t,hasSearchMatchesInNote:o,note:i,noteId:n}=this.props;if(!i)return s.a.createElement("div",{className:"note-detail-placeholder"},s.a.createElement(U.a,null));var r=!!i.deleted;return s.a.createElement("div",{className:"note-editor theme-color-bg theme-color-fg"},e||!i.systemTags.includes("markdown")?s.a.createElement(G,{storeFocusEditor:this.storeFocusEditor,storeHasFocus:this.storeEditorHasFocus}):s.a.createElement(Y.default,{noteId:n}),i&&!r&&s.a.createElement(k,{storeFocusTagField:this.storeFocusTagField,storeHasFocus:this.storeTagFieldHasFocus}),t&&o&&s.a.createElement(u,null))}}n()(V,"displayName","NoteEditor");var q={toggleNoteList:F.a.ui.toggleNoteList,toggleMarkdown:F.a.data.markdownNote,toggleEditMode:F.a.ui.toggleEditMode};t.default=Object(a.b)(e=>({allTags:e.data.tags,editMode:e.ui.editMode,keyboardShortcuts:e.settings.keyboardShortcuts,isEditorActive:!e.ui.showNavigation,noteId:e.ui.openedNote,note:e.data.notes.get(e.ui.openedNote),revision:e.ui.selectedRevision,hasSearchQuery:""!==e.ui.searchQuery,hasSearchMatchesInNote:!!e.ui.numberOfMatchesInNote&&e.ui.numberOfMatchesInNote>0,isSearchActive:!!e.ui.searchQuery.length,isSmallScreen:L.c(e)}),q)(V)},537:function(e,t,o){"use strict";o.r(t),o.d(t,"NotePreview",(function(){return y}));var i=o(0),n=o.n(i),r=o(65),s=o(287),a=o(272),l=o(532),c=o.n(l),d=o(533),u=o.n(d),h=o(24),p={type:"output",regex:'<input type="checkbox" disabled',replace:'<input type="checkbox" '},g=e=>o.e(18).then(o.t.bind(null,1010,7)).then(t=>{var{default:o}=t;o.extension("enableCheckboxes",p);var i=new o.Converter({extensions:["enableCheckboxes"]});i.setFlavor("github"),i.setOption("simpleLineBreaks",!1),i.setOption("ghMentions",!1),i.setOption("smoothLivePreview",!0),i.setOption("tables",!0),i.setOption("strikethrough",!0);var n=e.replace(/([ \t\u2000-\u200a]*)\u2022(\s)/gm,"$1-$2");return(e=>{for(var t=(new DOMParser).parseFromString(e,"text/html"),o=t.createTreeWalker(t.body,NodeFilter.SHOW_ALL,null,!1),i=[],n=[],r=function(){var e=o.currentNode;if((e=>{switch(e.nodeName.toLowerCase()){case"head":case"html":case"iframe":case"link":case"meta":case"object":case"script":case"style":return!0;default:return!1}})(e))return n.push(e),"continue";if(!(e=>{var t=e.nodeName.toLowerCase();if("input"===t)return"checkbox"===e.getAttribute("type");switch(t){case"#text":case"a":case"article":case"b":case"br":case"blockquote":case"cite":case"code":case"dd":case"del":case"div":case"dt":case"em":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":case"hr":case"i":case"img":case"ins":case"kbd":case"li":case"ol":case"p":case"pre":case"s":case"span":case"strong":case"sub":case"sup":case"table":case"tbody":case"td":case"th":case"thead":case"tr":case"tt":case"ul":return!0;default:return!1}})(e))return i.push(e),"continue";var t=e.nodeName.toLowerCase();Object(h.filter)(e.attributes,e=>{var{name:o,value:i}=e;return!((e,t,o)=>{switch(e){case"a":switch(t){case"href":return["http","https","simplenote"].includes(o.toLowerCase().trim().split("://")[0]);case"alt":case"rel":case"title":return!0;default:return!1}case"img":switch(t){case"alt":case"src":case"title":case"width":return!0;default:return!1}case"input":switch(t){case"disabled":case"checked":case"type":return!0;default:return!1}case"li":switch(t){case"class":switch(o){case"task-list-item":return!0;default:return!1}default:return!1}case"ol":switch(t){case"start":return!0;default:return!1}case"th":case"td":switch(t){case"style":switch(o){case"text-align:center;":case"text-align:left;":case"text-align:right;":return!0;default:return!1}default:return!1}default:return!1}})(t,o,i)&&(("href"!==o&&"src"!==o||!u.a.isWebUri(i))&&("href"!==o||!i.startsWith("mailto:")||!c.a.validate(i.slice(7))))}).forEach(t=>{var{name:o}=t;return e.removeAttribute(o)});var r="a"===t&&e.getAttribute("href");"a"!==t||"string"!=typeof r||r.startsWith("mailto:")||(e.setAttribute("target","_blank"),e.setAttribute("rel","external noopener noreferrer")),"li"===t&&"task-list-item"===e.getAttribute("class")&&e.setAttribute("style","list-style: none;")};o.nextNode();)r();return n.forEach(e=>{try{var t;null==e||null===(t=e.parentNode)||void 0===t||t.removeChild(e)}catch(e){}}),i.forEach(e=>{var t,o=e.parentNode;try{for(;t=e.firstChild;)null==o||o.insertBefore(t,e);null==o||o.removeChild(e)}catch(e){}}),t.body.innerHTML})(i.makeHtml(n))}),m=(e,t)=>{var o=e.parentNode;t.forEach(e=>{o.childNodes.forEach(o=>{var i,n,r;if(o.nodeType===Node.TEXT_NODE&&null!==(i=o.textContent)&&void 0!==i&&i.toLocaleLowerCase().includes(e)){var s=null===(n=o.textContent)||void 0===n?void 0:n.toLocaleLowerCase().indexOf(e),a=o.splitText(s),l=a.splitText(e.length),c=document.createElement("span");c.setAttribute("class","search-match"),null===(r=a.parentNode)||void 0===r||r.replaceChild(c,a),c.appendChild(a),m(l,t)}})})},v=(e,t,i)=>g(t).then(t=>(e.innerHTML=t,e)).then(e=>{if(!i)return e.querySelectorAll("pre code");var t=Object(a.a)(i).map(e=>e.toLocaleLowerCase());if(!t.length)return e.querySelectorAll("pre code");for(var o=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:function(e){return t.some(t=>{var o;return null===(o=e.textContent)||void 0===o?void 0:o.toLocaleLowerCase().includes(t)})?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},!1),n=[],r=o.currentNode;r;)n.push(r),r=o.nextNode();return n.forEach(e=>m(e,t)),e.querySelectorAll("pre code")}).then(e=>{if(e.length)return o.e(14).then(o.t.bind(null,1009,7)).then(t=>{var{default:o}=t;e.forEach(o.highlightBlock)}).catch()}),f=o(32),b=o(214),y=e=>{var t,{"aria-hidden":o,editNote:r,isFocused:a,note:l,noteId:c,notes:d,openNote:u,searchQuery:h,showRenderedView:p}=e,g=Object(i.useRef)();return Object(i.useEffect)(()=>{var e=e=>{if(!a)return!0;if(!document.getSelection().isCollapsed)return!0;var t=document.createElement("div");v(t,l.content,h).then(()=>{try{e.clipboardData.setData("text/plain",t.innerHTML)}catch(e){navigator.clipboard.writeText(t.innerHTML)}}),e.preventDefault()};return document.addEventListener("copy",e,!1),()=>document.removeEventListener("copy",e,!1)},[a,h]),Object(i.useEffect)(()=>{var e,t=e=>{for(var t,o,i=e.target;null!==i;i=i.parentNode)if("A"===i.tagName){e.preventDefault(),e.stopPropagation();var n=i;if(n.href.startsWith("simplenote://note/")){var a=/^simplenote:\/\/note\/(.+)$/.exec(n.href);if(!a)return;var[h,p]=a;return void(d.has(p)&&u(p))}return void(n.href.startsWith("http://localhost")||Object(f.a)(n.href))}var m="INPUT"===(null==e||null===(t=e.target)||void 0===t?void 0:t.tagName)?e.target.parentElement:e.target;if("INPUT"!==(null==m||null===(o=m.children[0])||void 0===o?void 0:o.tagName));else{e.preventDefault(),e.stopPropagation();var v=g.current.querySelectorAll("[data-markdown-root] .task-list-item"),b=Array.prototype.indexOf.call(v,m),y=0,S=l.content.replace(s.a,(e,t,o,i)=>t+(y++===b?" "===o?"- [x]":"- [ ]":" "===o?"- [ ]":"- [x]")+i);r(c,{content:S})}};return null===(e=g.current)||void 0===e||e.addEventListener("click",t,!0),()=>{var e;return null===(e=g.current)||void 0===e?void 0:e.removeEventListener("click",t,!0)}},[l.content]),Object(i.useEffect)(()=>{var e;g.current&&(null!=l&&l.content&&p?v(g.current,l.content,h):g.current.innerText=Object(s.b)(null!==(e=null==l?void 0:l.content)&&void 0!==e?e:""))},[null==l?void 0:l.content,h,p]),n.a.createElement("div",{"aria-hidden":o,className:"note-detail-wrapper"},n.a.createElement("div",{className:"note-detail note-detail-preview"},n.a.createElement("div",{ref:g,className:"note-detail-markdown theme-color-bg theme-color-fg","data-markdown-root":!0},n.a.createElement("div",{style:{whiteSpace:"pre"}},!p&&Object(s.b)(null!==(t=null==l?void 0:l.content)&&void 0!==t?t:"")))))},S={editNote:b.a.data.editNote,openNote:b.a.ui.selectNote};t.default=Object(r.b)((e,t)=>{var o,i,n=null!==(o=t.noteId)&&void 0!==o?o:e.ui.openedNote,r=null!==(i=t.note)&&void 0!==i?i:e.data.notes.get(n);return{isFocused:0===e.ui.dialogs.length&&!e.ui.showNoteInfo,note:r,noteId:n,notes:e.data.notes,searchQuery:e.ui.searchQuery,showRenderedView:!(null==r||!r.systemTags.includes("markdown")||e.ui.editMode)}},S)(y)}}]);